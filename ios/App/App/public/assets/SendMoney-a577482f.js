import{_ as H,A as O,B as Y,i as $,r as u,j as g,a8 as K,k as X,a9 as J,o as v,c as _,w as a,u as e,a as t,D as Q,E as W,a1 as Z,G as ee,b as i,H as ae,h as te,O as D,q as F,s as T,ac as ne,al as oe,v as r,t as c,g as j,x as h,L as le,M as I,N as C,ae as S,R as se,X as ue,I as z,e as ie,K as re,P as de,y as ce,z as fe}from"./index-4698ed6d.js";import{r as pe,i as ve,l as P}from"./simple-mask-money.esm-e69c5c5f.js";const R=f=>(ce("data-v-805848a1"),f=f(),fe(),f),_e={class:"d-flex flex-column justify-content-space-between h-100"},me=R(()=>r("b",null,"Send to:",-1)),ye=R(()=>r("label",{for:"inputValue"},"Amount",-1)),he=["disabled"],Ie={__name:"SendMoney",props:{pairPhone:{type:String,required:!0}},setup(f){const x=O(),q=Y(),V=$("axios"),w=f,d=u({vcard:x.params.phoneNumber,value:0,pair_vcard:w.pairPhone,confirmation_code:"",autoSave:!1}),m=u(null),o=u({value:[],confirmation_code:[]}),B=u(!1),s=u(!1),p=u(null),y=u(!1),k=g(()=>{var n;return(n=x.query.name)!=null?n:w.pairPhone}),M=()=>{o.value.value=[],o.value.confirmation_code=[];const n=P(p.value);let l=!0;(!n||n<=0)&&(l=!1,o.value.value.push("The amount must be greater than 0")),n>N.value&&(l=!1,o.value.value.push("You don't have enough balance to send this amount")),d.value.confirmation_code||(l=!1,o.value.confirmation_code.push("You must enter a your confirmation code")),B.value=l},A=()=>{s.value=!0,V.post("/transactions",d.value).then(n=>{s.value=!1,y.value=!0}).catch(n=>{s.value=!1,o.value=n.response.data.errors})};K(p,n=>{n&&(n?d.value.value=P(n):d.value.value=0)});const L=()=>{V.get("/vcard/".concat(x.params.phoneNumber)).then(n=>{m.value=n.data.data})},U=new Intl.NumberFormat("pt",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),N=g(()=>m.value?(m.value.balance-m.value.piggy_bank_balance).toFixed(2):0),E=g(()=>{const n=U.format(N.value);return"".concat(n," €")}),G=()=>{y.value=!1,q.go(-1)};return X(()=>{pe("#inputValue",{suffix:"€",fixed:!0,fractionDigits:2,decimalSeparator:",",thousandsSeparator:"."}),L()}),J(()=>{ve("#inputValue")}),(n,l)=>(v(),_(e(de),null,{default:a(()=>[t(e(ae),null,{default:a(()=>[t(e(Q),null,{default:a(()=>[t(e(W),{slot:"start"},{default:a(()=>[t(e(Z))]),_:1}),t(e(ee),null,{default:a(()=>[i("Send Money")]),_:1})]),_:1})]),_:1}),t(e(D),{class:"ion-padding"},{default:a(()=>[y.value?(v(),_(e(te),{key:0,"is-open":y.value},{default:a(()=>[t(e(D),{class:"ion-text-center"},{default:a(()=>[t(e(F),null,{default:a(()=>[t(e(T),null,{default:a(()=>[t(e(ne),{icon:e(oe),style:{"font-size":"64px",color:"green"}},null,8,["icon"]),r("p",null,c(p.value)+" sent to "+c(k.value),1)]),_:1})]),_:1}),t(e(j),{expand:"full",color:"success",onClick:G},{default:a(()=>[i("Continue")]),_:1})]),_:1})]),_:1},8,["is-open"])):h("",!0),r("div",_e,[t(e(le),null,{default:a(()=>[t(e(I),{class:"ion-justify-content-center"},{default:a(()=>[r("h3",null,[r("b",null,"Available Balance: "+c(E.value),1)])]),_:1}),t(e(I),null,{default:a(()=>[t(e(C),{size:"12"},{default:a(()=>[t(e(S),null,{default:a(()=>[me,i(" "+c(k.value),1)]),_:1})]),_:1})]),_:1}),t(e(I),null,{default:a(()=>[t(e(C),{size:"12",style:{display:"flex","flex-direction":"column","justify-content":"center"}},{default:a(()=>[ye,se(r("input",{id:"inputValue",type:"text",style:{"text-align":"center","font-size":"30px",width:"100%"},onInput:M,placeholder:"0,00€","onUpdate:modelValue":l[0]||(l[0]=b=>p.value=b),disabled:s.value},null,40,he),[[ue,p.value]]),o.value&&o.value.value?(v(),_(e(S),{key:0,color:"danger"},{default:a(()=>[i(c(o.value.value[0]),1)]),_:1})):h("",!0)]),_:1}),t(e(C),{size:"12"},{default:a(()=>[t(e(z),{position:"floating"},{default:a(()=>[i("Confirmation Code")]),_:1}),t(e(ie),{type:"password",placeholder:"Enter your Confirmation Code",maxlength:3,onIonInput:M,modelValue:d.value.confirmation_code,"onUpdate:modelValue":l[1]||(l[1]=b=>d.value.confirmation_code=b),disabled:s.value},null,8,["modelValue","disabled"]),o.value&&o.value.confirmation_code?(v(),_(e(S),{key:0,color:"danger"},{default:a(()=>[i(c(o.value.confirmation_code[0]),1)]),_:1})):h("",!0)]),_:1})]),_:1})]),_:1}),t(e(I),{class:"ion-justify-content-center w-100",style:{"align-self":"center"}},{default:a(()=>[t(e(F),{class:"w-100"},{default:a(()=>[t(e(T),{style:{display:"flex","flex-direction":"column","align-items":"center"}},{default:a(()=>[t(e(j),{disabled:!B.value||s.value,onClick:A},{default:a(()=>[t(e(z),{class:"ion-label-w-spinner"},{default:a(()=>[i("Send "),s.value?(v(),_(e(re),{key:0})):h("",!0)]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}))}},ge=H(Ie,[["__scopeId","data-v-805848a1"]]);export{ge as default};
