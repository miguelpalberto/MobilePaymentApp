import{_ as H,i as R,r as p,j as u,a8 as U,k as E,a9 as G,o as v,c as y,w as e,u as a,aa as L,ab as W,a as l,D as X,E as J,a1 as K,G as Q,b as g,H as Y,h as Z,O as V,q as aa,s as ea,n as ta,g as B,x as I,M as P,N as m,v as n,t as h,ac as la,R as na,X as sa,I as oa,P as ca,y as ua,z as ia}from"./index-4698ed6d.js";import{r as ra,i as da,l as _a}from"./simple-mask-money.esm-e69c5c5f.js";const f=i=>(ua("data-v-f65022f7"),i=i(),ia(),i),pa=f(()=>n("br",null,null,-1)),ga=f(()=>n("p",null,"Balances have been updated!",-1)),fa=f(()=>n("b",null,"Total Balance:",-1)),ba={class:"transfer-card"},va=f(()=>n("h4",{class:"ion-text-center"},"Available Balance",-1)),ya={class:"transfer-card-value"},ma={class:"flow-transfer-container"},ha={class:"transfer-card"},ka=f(()=>n("h4",{class:"ion-text-center"},"Piggy Bank Balance",-1)),xa={class:"transfer-card-value"},Ba={__name:"PiggyBank",props:{phone:{type:String,required:!0}},setup(i){const w=R("axios"),C=i,r=p(!0),o=p({}),d=p(null),b=p(!1),s=p({balance:null,piggy_bank_balance:null}),N=u(()=>o.value.piggy_bank_balance),k=new Intl.NumberFormat("pt",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),S=u(()=>_.value||_.value>0),_=u(()=>_a(d.value)),F=u(()=>(s.value.balance-s.value.piggy_bank_balance).toFixed(2)),T=u(()=>r.value?L:W),z=u(()=>{const t=k.format(s.value.balance);return"".concat(t," €")}),D=u(()=>{const t=k.format(F.value);return"".concat(t," €")}),j=u(()=>{const t=k.format(s.value.piggy_bank_balance);return"".concat(t," €")});U(_,t=>{t&&(r.value?t>F.value?o.value={piggy_bank_balance:["Cannot store more money than the Total Balance in the Piggy Bank Vault"]}:o.value={}:t>s.value.piggy_bank_balance?o.value={piggy_bank_balance:["The amount being withdrawn is greater than the current Piggy Bank Vault balance"]}:o.value={})});const A=()=>{w.get("/vcard/".concat(C.phone)).then(t=>{const{balance:c,piggy_bank_balance:x}=t.data.data;s.value.balance=c,s.value.piggy_bank_balance=x})},M=async t=>{o.value={};try{const c=await w.patch("/vcards/".concat(C.phone,"/updatePiggyBankBalance"),{piggy_bank_balance:t});s.value.balance=c.data.data.balance,s.value.piggy_bank_balance=c.data.data.piggy_bank_balance,d.value=null,b.value=!0}catch(c){c.response.status===422&&(o.value=c.response.data.errors)}};E(()=>{ra("#inputValue",{suffix:"€",fixed:!0,fractionDigits:2,decimalSeparator:",",thousandsSeparator:"."}),A()}),G(()=>{da("#inputValue")});const $=async()=>{let t;r.value?t=parseFloat(s.value.piggy_bank_balance)+_.value:t=parseFloat(s.value.piggy_bank_balance)-_.value,t=t.toFixed(2),await M(t)},O=()=>{r.value=!r.value,d.value=null},q=()=>{b.value=!1};return(t,c)=>(v(),y(a(ca),null,{default:e(()=>[l(a(Y),null,{default:e(()=>[l(a(X),null,{default:e(()=>[l(a(J),{slot:"start"},{default:e(()=>[l(a(K))]),_:1}),l(a(Q),null,{default:e(()=>[g("Piggy Bank Vault")]),_:1})]),_:1})]),_:1}),l(a(V),{fullscreen:!0},{default:e(()=>[pa,b.value?(v(),y(a(Z),{key:0,"is-open":b.value},{default:e(()=>[l(a(V),{class:"ion-text-center"},{default:e(()=>[l(a(aa),null,{default:e(()=>[l(a(ea),null,{default:e(()=>[l(a(ta),null,{default:e(()=>[g("Success")]),_:1}),ga]),_:1})]),_:1}),l(a(B),{expand:"full",color:"success",onClick:q},{default:e(()=>[g("Close")]),_:1})]),_:1})]),_:1},8,["is-open"])):I("",!0),l(a(P),null,{default:e(()=>[l(a(m),{size:"12",style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},{default:e(()=>[fa,n("b",null,h(z.value),1)]),_:1}),l(a(m),{size:"12",style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},{default:e(()=>[n("div",ba,[va,n("h5",ya,h(D.value),1)]),n("div",ma,[l(a(B),{fill:"clear",style:{"border-radius":"15px",padding:"0","background-color":"rgb(37, 203, 224)"},onClick:O},{default:e(()=>[l(a(la),{style:{"font-size":"30px"},color:"light",icon:T.value},null,8,["icon"])]),_:1})]),n("div",ha,[ka,n("h5",xa,h(j.value),1)])]),_:1}),l(a(m),{size:"12",style:{display:"flex","justify-content":"center"}},{default:e(()=>[na(n("input",{id:"inputValue",type:"text",style:{"text-align":"center","font-size":"30px"},placeholder:"0,00€","onUpdate:modelValue":c[0]||(c[0]=x=>d.value=x)},null,512),[[sa,d.value]])]),_:1})]),_:1}),l(a(P),null,{default:e(()=>[l(a(m),{size:"12",style:{display:"flex","flex-direction":"column","justify-content":"center","align-items":"center",gap:"10px"}},{default:e(()=>[S.value?(v(),y(a(B),{key:0,disabled:N.value,onClick:$},{default:e(()=>[g("Apply")]),_:1},8,["disabled"])):I("",!0),o.value&&o.value.piggy_bank_balance?(v(),y(a(oa),{key:1,style:{color:"red","font-size":"14px"}},{default:e(()=>[g(h(o.value.piggy_bank_balance[0]),1)]),_:1})):I("",!0)]),_:1})]),_:1})]),_:1})]),_:1}))}},Ca=H(Ba,[["__scopeId","data-v-f65022f7"]]);export{Ca as default};
