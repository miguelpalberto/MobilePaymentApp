import{_ as j,r as d,j as L,W as I,o as u,J as C,a,w as e,u as t,D as H,E as N,g as B,b as f,G as ee,H as W,R as A,v as n,X as M,c as g,Y as P,x as k,T as R,f as q,Z as te,$ as z,O as G,V as J,a0 as K,y as X,z as Y,i as ae,k as le,a1 as oe,K as ne,a2 as se,t as E,a3 as ue,a4 as ie,a5 as ce,a6 as de,U as re,P as _e,I as ve,a7 as pe}from"./index-4698ed6d.js";const S=r=>(X("data-v-53f8b3dd"),r=r(),Y(),r),fe=S(()=>n("br",null,null,-1)),me=S(()=>n("br",null,null,-1)),ye=S(()=>n("label",{class:"label"},"Start Date:",-1)),De=["disabled"],ge=S(()=>n("br",null,null,-1)),be=S(()=>n("label",{class:"label"},"End Date:",-1)),he=["disabled"],Be=S(()=>n("br",null,null,-1)),Ie={__name:"TransactionsFilter",props:["filterByDate","filterByType"],setup(r){var o,c;const w=r;d();const D=d(!1),m=d(!1),b=d(((o=w.filterByDate)==null?void 0:o.startDate)||new Date(1990,1,1).toISOString()),_=d(((c=w.filterByDate)==null?void 0:c.endDate)||new Date().toISOString()),T=d(w.filterByType||"All"),V=L(()=>new Date(b.value).toLocaleString("pt",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1})),y=L(()=>new Date(_.value).toLocaleString("pt",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1})),v=()=>K.dismiss(null,"cancel"),h=()=>K.dismiss({filterByDate:{startDate:b.value,endDate:_.value},filterByType:{selectedType:T.value}},"confirm"),F=()=>{m.value=!1,D.value=!0},x=()=>D.value=!1,O=()=>{D.value=!1,m.value=!0},s=()=>m.value=!1;return(i,l)=>{const U=I("ion-list");return u(),C(J,null,[a(t(W),null,{default:e(()=>[a(t(H),null,{default:e(()=>[a(t(N),{slot:"start"},{default:e(()=>[a(t(B),{color:"medium",onClick:v},{default:e(()=>[f("Reset")]),_:1})]),_:1}),a(t(ee),null,{default:e(()=>[f("Filters")]),_:1}),a(t(N),{slot:"end"},{default:e(()=>[a(t(B),{onClick:h,strong:!0},{default:e(()=>[f("Confirm")]),_:1})]),_:1})]),_:1})]),_:1}),a(t(G),{class:"ion-padding"},{default:e(()=>[fe,me,A(n("div",null,[ye,A(n("input",{class:"dateInput","onUpdate:modelValue":l[0]||(l[0]=p=>V.value=p),onClick:F,disabled:D.value},null,8,De),[[M,V.value]]),D.value?(u(),g(t(P),{key:0,modelValue:b.value,"onUpdate:modelValue":l[1]||(l[1]=p=>b.value=p),locale:"pt-pt"},null,8,["modelValue"])):k("",!0),D.value?(u(),g(t(B),{key:1,onClick:x},{default:e(()=>[f("OK")]),_:1})):k("",!0)],512),[[R,!m.value]]),ge,A(n("div",null,[be,A(n("input",{class:"dateInput","onUpdate:modelValue":l[2]||(l[2]=p=>y.value=p),onClick:O,disabled:m.value},null,8,he),[[M,y.value]]),m.value?(u(),g(t(P),{key:0,modelValue:_.value,"onUpdate:modelValue":l[3]||(l[3]=p=>_.value=p),locale:"pt-pt"},null,8,["modelValue"])):k("",!0),m.value?(u(),g(t(B),{key:1,onClick:s},{default:e(()=>[f("OK")]),_:1})):k("",!0)],512),[[R,!D.value]]),a(U,null,{default:e(()=>[Be,a(t(q),null,{default:e(()=>[a(t(te),{"aria-label":"Type",interface:"popover",placeholder:"Select transaction type",modelValue:T.value,"onUpdate:modelValue":l[4]||(l[4]=p=>T.value=p)},{default:e(()=>[a(t(z),{value:"All"},{default:e(()=>[f("All")]),_:1}),a(t(z),{value:"Debit"},{default:e(()=>[f("Debit")]),_:1}),a(t(z),{value:"Credit"},{default:e(()=>[f("Credit")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})],64)}}},ke=j(Ie,[["__scopeId","data-v-53f8b3dd"]]);const Z=r=>(X("data-v-73a1de48"),r=r(),Y(),r),Se={key:0},we={key:1},Te={class:"container"},Ce={class:"filters"},Ve={class:"sorts"},xe=Z(()=>n("p",null,"Reference:",-1)),$e={key:1},Ae=Z(()=>n("p",null,"No transactions",-1)),Ee=[Ae],Fe={__name:"Transactions",props:{phone:{type:String,required:!0}},setup(r){const w=r,D=ae("axios"),m=d(!0),b=d([]),_=d("value"),T=()=>_.value="date",V=()=>_.value="value",y=d("asc"),v=d(null),h=d("All"),F=()=>{y.value=="asc"?y.value="desc":y.value="asc"},x=L(()=>{let s=b.value;return v.value&&v.value.startDate&&v.value.endDate&&(s=s.filter(o=>{const c=new Date(o.datetime),i=new Date(v.value.startDate),l=new Date(v.value.endDate);return c>=i&&c<=l})),h.value&&h.value!=="All"&&(s=s.filter(o=>o.type===h.value)),_.value==="date"?s.sort((o,c)=>{const i=new Date(o.datetime),l=new Date(c.datetime);return y.value==="asc"?i-l:l-i}):_.value==="value"&&s.sort((o,c)=>{const i=parseFloat(o.value.replace("€","")),l=parseFloat(c.value.replace("€",""));return y.value==="asc"?l-i:i-l}),s}),O=async()=>{const s=await K.create({component:ke,componentProps:{filterByDate:v.value,filterByType:h.value}});s.present();const{data:o,role:c}=await s.onWillDismiss();console.log(o),v.value=o==null?void 0:o.filterByDate,h.value=o==null?void 0:o.filterByType.selectedType,console.log(h.value)};return le(()=>{D.get("vcards/".concat(w.phone,"/transactions")).then(s=>{b.value=s.data.data,console.log(b.value),m.value=!1}).catch(s=>{console.log(s)})}),(s,o)=>{const c=I("ion-title"),i=I("ion-icon"),l=I("ion-col"),U=I("ion-row"),p=I("ion-grid"),Q=I("ion-list");return u(),g(t(_e),null,{default:e(()=>[a(t(W),null,{default:e(()=>[a(t(H),null,{default:e(()=>[a(t(N),{slot:"start"},{default:e(()=>[a(t(oe))]),_:1}),a(c,null,{default:e(()=>[f("Transactions")]),_:1})]),_:1})]),_:1}),a(t(G),{class:"ion-padding"},{default:e(()=>[m.value?(u(),C("div",Se,[a(t(ne))])):(u(),C("div",we,[n("div",null,[n("div",Te,[n("div",Ce,[a(t(B),{class:"custom-button-filters",onClick:O,expand:"block",fill:"solid"},{default:e(()=>[f(" Filters "),a(t(se),{color:"danger"},{default:e(()=>[f(E(v.value!=null&&v.value.startDate?"*":""),1)]),_:1})]),_:1})]),n("div",Ve,[a(t(B),{class:"custom-button-sorts date-button",disabled:_.value=="date",size:"",onClick:T},{default:e(()=>[a(i,{icon:t(ue)},null,8,["icon"])]),_:1},8,["disabled"]),a(t(B),{class:"custom-button-sorts euro-button",disabled:_.value=="value",onClick:V},{default:e(()=>[a(i,{icon:t(ie)},null,8,["icon"])]),_:1},8,["disabled"]),a(t(B),{class:"custom-button-sorts arrow-button",onClick:F},{default:e(()=>[y.value=="asc"?(u(),g(i,{key:0,icon:t(ce)},null,8,["icon"])):k("",!0),y.value=="desc"?(u(),g(i,{key:1,icon:t(de)},null,8,["icon"])):k("",!0)]),_:1})])]),x.value.length>0?(u(),g(Q,{key:0},{default:e(()=>[(u(!0),C(J,null,re(x.value,$=>(u(),g(t(q),null,{default:e(()=>[a(t(ve),null,{default:e(()=>[a(p,null,{default:e(()=>[a(U,null,{default:e(()=>[a(l,{size:"12"},{default:e(()=>[xe,n("h1",null,E($.payment_reference),1)]),_:2},1024),a(l,{size:"8",style:{"margin-top":"5px"}},{default:e(()=>[n("p",null,E($.datetime),1)]),_:2},1024),a(l,{size:"4",class:"ion-text-end"},{default:e(()=>[n("h1",{style:pe([{padding:"0",margin:"0"},{color:$.value.includes("-")?"red":"green"}]),color:"success"},E($.value),5)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1})):(u(),C("div",$e,Ee))])]))]),_:1})]),_:1})}}},Ue=j(Fe,[["__scopeId","data-v-73a1de48"]]);export{Ue as default};
